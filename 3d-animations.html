<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Projects</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <nav id="navbar"></nav>
    <script>
        fetch("nav.html")
            .then((res) => res.text())
            .then((html) => (document.getElementById("navbar").innerHTML = html))
            .catch((err) => console.error("Navigation load failed:", err));
    </script>

    <header id="header"></header>
    <script>
        fetch("header.html")
            .then((res) => res.text())
            .then((html) => (document.getElementById("header").innerHTML = html))
            .catch((err) => console.error("Header load failed:", err));
    </script>
    <div class="margin-l">
        <div id="section-buttons" class="i3 "></div>
        <div id="projects-container"></div>
        <script>
            // 你想要显示的分类名称
            const targetCategory = "3D Animations";   // ← 改成任何你想要的分类

            fetch("complete-projects.json")
                .then(res => res.json())
                .then(data => {

                    // 如果 category 不存在：报错并退出
                    if (!data[targetCategory]) {
                        console.error("Category not found:", targetCategory);
                        return;
                    }

                    const container = document.getElementById("projects-container");
                    container.innerHTML = "";

                    // 创建分类 section
                    const section = document.createElement("section");
                    section.id = targetCategory.replace(/\s+/g, "");

                    const h3 = document.createElement("h3");
                    h3.textContent = targetCategory;
                    section.appendChild(h3);

                    // 渲染该分类下所有项目
                    data[targetCategory].forEach((p, idx) => {

                        const a = document.createElement("a");
                        a.href = p.link || "#";

                        const itemDiv = document.createElement("div");
                        itemDiv.className = "link-outline proj-content";

                        // 封面图
                        const coverImg = document.createElement("img");
                        coverImg.className = "image";
                        coverImg.src = p.cover || "";
                        coverImg.alt = p.title || "";

                        // hover 媒体（视频或图片）
                        let hoverNode = null;
                        if (p.hover) {
                            if (p.hoverType === "video") {
                                const wrapper = document.createElement("div");
                                wrapper.className = "image-secondary";
                                const video = document.createElement("video");
                                video.autoplay = true;
                                video.loop = true;
                                video.muted = true;
                                video.playsInline = true;
                                video.style.width = "100%";
                                video.style.height = "100%";
                                video.style.objectFit = "cover";

                                const source = document.createElement("source");
                                source.src = p.hover;
                                video.appendChild(source);
                                wrapper.appendChild(video);

                                hoverNode = wrapper;
                            } else {
                                const hoverImg = document.createElement("img");
                                hoverImg.className = "image-secondary";
                                hoverImg.src = p.hover;
                                hoverImg.alt = (p.title || "") + " hover";
                                hoverImg.style.width = "100%";
                                hoverImg.style.maxHeight = "500px";
                                hoverImg.style.objectFit = "cover";

                                hoverNode = hoverImg;
                            }
                        }

                        // pixel 风格处理
                        if (p.pixel) {
                            coverImg.classList.add("pixel");
                            if (hoverNode) hoverNode.classList.add("pixel");
                        }

                        // 文本内容
                        const textDiv = document.createElement("div");
                        textDiv.className = "proj-text";

                        const titleH3 = document.createElement("h3");
                        titleH3.textContent = p.title || "";

                        const metaP = document.createElement("p");
                        metaP.innerHTML = `${p.date || ""}<br>${p.tools || ""}<br>${p.role || ""}`;

                        textDiv.appendChild(titleH3);
                        textDiv.appendChild(document.createElement("br"));
                        textDiv.appendChild(document.createElement("br"));
                        textDiv.appendChild(metaP);

                        if (p.description) {
                            textDiv.appendChild(document.createElement("br"));
                            textDiv.appendChild(document.createElement("br"));
                            const descP = document.createElement("p");
                            descP.textContent = p.description;
                            textDiv.appendChild(descP);
                        }

                        // 交替布局
                        const mediaContainer = document.createElement("div");
                        mediaContainer.appendChild(coverImg);
                        if (hoverNode) mediaContainer.appendChild(hoverNode);

                        if (idx % 2 === 0) {
                            // text 左，图 右
                            itemDiv.appendChild(textDiv);
                            itemDiv.appendChild(mediaContainer);
                        } else {
                            // 图 左，text 右
                            itemDiv.appendChild(mediaContainer);
                            itemDiv.appendChild(textDiv);
                        }

                        a.appendChild(itemDiv);
                        section.appendChild(a);
                    });

                    container.appendChild(section);
                })
                .catch(err => console.error("Project load failed:", err));
        </script>

    </div>
    <div id="back">
        <div class="sections" onclick="history.back()">
            <h4 class="block-display">Go Back</h4>
        </div>
    </div>



    <footer class="footer">
        <p>© Xiaoxuan Han 2025 All Rights Reserved.</p>
    </footer>

</body>

</html>